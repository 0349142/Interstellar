{"version":3,"file":"uv.handler.js","mappings":"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","sources":["webpack://@titaniumnetwork-dev/ultraviolet/./src/uv.handler.js"],"sourcesContent":["/**\r\n * @type {import('../uv').UltravioletCtor}\r\n */\r\nconst Ultraviolet = self.Ultraviolet;\r\n\r\n/**\r\n * @type {import('../uv').UVClientCtor}\r\n */\r\nconst UVClient = self.UVClient;\r\n\r\n/**\r\n * @type {import('../uv').UVConfig}\r\n */\r\nconst __uv$config = self.__uv$config;\r\n\r\n/**\r\n * @type {import('@tomphttp/bare-client').BareManifest}\r\n */\r\nconst __uv$bareData = self.__uv$bareData;\r\n\r\n/**\r\n * @type {string}\r\n */\r\nconst __uv$bareURL = self.__uv$bareURL;\r\n\r\n/**\r\n * @type {string}\r\n */\r\nconst __uv$cookies = self.__uv$cookies;\r\n\r\nif (\r\n    typeof __uv$bareData !== 'object' ||\r\n    typeof __uv$bareURL !== 'string' ||\r\n    typeof __uv$cookies !== 'string'\r\n)\r\n    throw new TypeError('Unable to load global UV data');\r\n\r\nif (!self.__uv) __uvHook(self);\r\n\r\nself.__uvHook = __uvHook;\r\n\r\n/**\r\n *\r\n * @param {typeof globalThis} window\r\n * @returns\r\n */\r\nfunction __uvHook(window) {\r\n    if ('__uv' in window && window.__uv instanceof Ultraviolet) return false;\r\n\r\n    if (window.document && !!window.window) {\r\n        window.document\r\n            .querySelectorAll('script[__uv-script]')\r\n            .forEach((node) => node.remove());\r\n    }\r\n\r\n    const worker = !window.window;\r\n    const master = '__uv';\r\n    const methodPrefix = '__uv$';\r\n    const __uv = new Ultraviolet(__uv$config);\r\n\r\n    /*if (typeof config.construct === 'function') {\r\n        config.construct(__uv, worker ? 'worker' : 'window');\r\n    }*/\r\n\r\n    // websockets\r\n    const bareClient = new Ultraviolet.BareClient(__uv$bareURL, __uv$bareData);\r\n\r\n    const client = new UVClient(window, bareClient, worker);\r\n    const {\r\n        HTMLMediaElement,\r\n        HTMLScriptElement,\r\n        HTMLAudioElement,\r\n        HTMLVideoElement,\r\n        HTMLInputElement,\r\n        HTMLEmbedElement,\r\n        HTMLTrackElement,\r\n        HTMLAnchorElement,\r\n        HTMLIFrameElement,\r\n        HTMLAreaElement,\r\n        HTMLLinkElement,\r\n        HTMLBaseElement,\r\n        HTMLFormElement,\r\n        HTMLImageElement,\r\n        HTMLSourceElement,\r\n    } = window;\r\n\r\n    client.nativeMethods.defineProperty(window, '__uv', {\r\n        value: __uv,\r\n        enumerable: false,\r\n    });\r\n\r\n    __uv.meta.origin = location.origin;\r\n    __uv.location = client.location.emulate(\r\n        (href) => {\r\n            if (href === 'about:srcdoc') return new URL(href);\r\n            if (href.startsWith('blob:')) href = href.slice('blob:'.length);\r\n            return new URL(__uv.sourceUrl(href));\r\n        },\r\n        (href) => {\r\n            return __uv.rewriteUrl(href);\r\n        }\r\n    );\r\n\r\n    let cookieStr = __uv$cookies;\r\n\r\n    __uv.meta.url = __uv.location;\r\n    __uv.domain = __uv.meta.url.host;\r\n    __uv.blobUrls = new window.Map();\r\n    __uv.referrer = '';\r\n    __uv.cookies = [];\r\n    __uv.localStorageObj = {};\r\n    __uv.sessionStorageObj = {};\r\n\r\n    if (__uv.location.href === 'about:srcdoc') {\r\n        __uv.meta = window.parent.__uv.meta;\r\n    }\r\n\r\n    if (window.EventTarget) {\r\n        __uv.addEventListener = window.EventTarget.prototype.addEventListener;\r\n        __uv.removeListener = window.EventTarget.prototype.removeListener;\r\n        __uv.dispatchEvent = window.EventTarget.prototype.dispatchEvent;\r\n    }\r\n\r\n    // Storage wrappers\r\n    client.nativeMethods.defineProperty(\r\n        client.storage.storeProto,\r\n        '__uv$storageObj',\r\n        {\r\n            get() {\r\n                if (this === client.storage.sessionStorage)\r\n                    return __uv.sessionStorageObj;\r\n                if (this === client.storage.localStorage)\r\n                    return __uv.localStorageObj;\r\n            },\r\n            enumerable: false,\r\n        }\r\n    );\r\n\r\n    if (window.localStorage) {\r\n        for (const key in window.localStorage) {\r\n            if (key.startsWith(methodPrefix + __uv.location.origin + '@')) {\r\n                __uv.localStorageObj[\r\n                    key.slice(\r\n                        (methodPrefix + __uv.location.origin + '@').length\r\n                    )\r\n                ] = window.localStorage.getItem(key);\r\n            }\r\n        }\r\n\r\n        __uv.lsWrap = client.storage.emulate(\r\n            client.storage.localStorage,\r\n            __uv.localStorageObj\r\n        );\r\n    }\r\n\r\n    if (window.sessionStorage) {\r\n        for (const key in window.sessionStorage) {\r\n            if (key.startsWith(methodPrefix + __uv.location.origin + '@')) {\r\n                __uv.sessionStorageObj[\r\n                    key.slice(\r\n                        (methodPrefix + __uv.location.origin + '@').length\r\n                    )\r\n                ] = window.sessionStorage.getItem(key);\r\n            }\r\n        }\r\n\r\n        __uv.ssWrap = client.storage.emulate(\r\n            client.storage.sessionStorage,\r\n            __uv.sessionStorageObj\r\n        );\r\n    }\r\n\r\n    let rawBase = window.document\r\n        ? client.node.baseURI.get.call(window.document)\r\n        : window.location.href;\r\n    let base = __uv.sourceUrl(rawBase);\r\n\r\n    client.nativeMethods.defineProperty(__uv.meta, 'base', {\r\n        get() {\r\n            if (!window.document) return __uv.meta.url.href;\r\n\r\n            if (client.node.baseURI.get.call(window.document) !== rawBase) {\r\n                rawBase = client.node.baseURI.get.call(window.document);\r\n                base = __uv.sourceUrl(rawBase);\r\n            }\r\n\r\n            return base;\r\n        },\r\n    });\r\n\r\n    __uv.methods = {\r\n        setSource: methodPrefix + 'setSource',\r\n        source: methodPrefix + 'source',\r\n        location: methodPrefix + 'location',\r\n        function: methodPrefix + 'function',\r\n        string: methodPrefix + 'string',\r\n        eval: methodPrefix + 'eval',\r\n        parent: methodPrefix + 'parent',\r\n        top: methodPrefix + 'top',\r\n    };\r\n\r\n    __uv.filterKeys = [\r\n        master,\r\n        __uv.methods.setSource,\r\n        __uv.methods.source,\r\n        __uv.methods.location,\r\n        __uv.methods.function,\r\n        __uv.methods.string,\r\n        __uv.methods.eval,\r\n        __uv.methods.parent,\r\n        __uv.methods.top,\r\n        methodPrefix + 'protocol',\r\n        methodPrefix + 'storageObj',\r\n        methodPrefix + 'url',\r\n        methodPrefix + 'modifiedStyle',\r\n        methodPrefix + 'config',\r\n        methodPrefix + 'dispatched',\r\n        'Ultraviolet',\r\n        '__uvHook',\r\n    ];\r\n\r\n    client.on('wrap', (target, wrapped) => {\r\n        client.nativeMethods.defineProperty(\r\n            wrapped,\r\n            'name',\r\n            client.nativeMethods.getOwnPropertyDescriptor(target, 'name')\r\n        );\r\n        client.nativeMethods.defineProperty(\r\n            wrapped,\r\n            'length',\r\n            client.nativeMethods.getOwnPropertyDescriptor(target, 'length')\r\n        );\r\n\r\n        client.nativeMethods.defineProperty(wrapped, __uv.methods.string, {\r\n            enumerable: false,\r\n            value: client.nativeMethods.fnToString.call(target),\r\n        });\r\n\r\n        client.nativeMethods.defineProperty(wrapped, __uv.methods.function, {\r\n            enumerable: false,\r\n            value: target,\r\n        });\r\n    });\r\n\r\n    client.fetch.on('request', (event) => {\r\n        event.data.input = __uv.rewriteUrl(event.data.input);\r\n    });\r\n\r\n    client.fetch.on('requestUrl', (event) => {\r\n        event.data.value = __uv.sourceUrl(event.data.value);\r\n    });\r\n\r\n    client.fetch.on('responseUrl', (event) => {\r\n        event.data.value = __uv.sourceUrl(event.data.value);\r\n    });\r\n\r\n    // XMLHttpRequest\r\n    client.xhr.on('open', (event) => {\r\n        event.data.input = __uv.rewriteUrl(event.data.input);\r\n    });\r\n\r\n    client.xhr.on('responseUrl', (event) => {\r\n        event.data.value = __uv.sourceUrl(event.data.value);\r\n    });\r\n\r\n    // Workers\r\n    client.workers.on('worker', (event) => {\r\n        event.data.url = __uv.rewriteUrl(event.data.url);\r\n    });\r\n\r\n    client.workers.on('addModule', (event) => {\r\n        event.data.url = __uv.rewriteUrl(event.data.url);\r\n    });\r\n\r\n    client.workers.on('importScripts', (event) => {\r\n        for (const i in event.data.scripts) {\r\n            event.data.scripts[i] = __uv.rewriteUrl(event.data.scripts[i]);\r\n        }\r\n    });\r\n\r\n    client.workers.on('postMessage', (event) => {\r\n        let to = event.data.origin;\r\n\r\n        event.data.origin = '*';\r\n        event.data.message = {\r\n            __data: event.data.message,\r\n            __origin: __uv.meta.url.origin,\r\n            __to: to,\r\n        };\r\n    });\r\n\r\n    // Navigator\r\n    client.navigator.on('sendBeacon', (event) => {\r\n        event.data.url = __uv.rewriteUrl(event.data.url);\r\n    });\r\n\r\n    // Cookies\r\n    client.document.on('getCookie', (event) => {\r\n        event.data.value = cookieStr;\r\n    });\r\n\r\n    client.document.on('setCookie', (event) => {\r\n        __uv.cookie.db().then((db) => {\r\n            __uv.cookie.setCookies(event.data.value, db, __uv.meta);\r\n\r\n            __uv.cookie.getCookies(db).then((cookies) => {\r\n                cookieStr = __uv.cookie.serialize(cookies, __uv.meta, true);\r\n            });\r\n        });\r\n\r\n        const cookie = __uv.cookie.setCookie(event.data.value)[0];\r\n\r\n        if (!cookie.path) cookie.path = '/';\r\n        if (!cookie.domain) cookie.domain = __uv.meta.url.hostname;\r\n\r\n        if (__uv.cookie.validateCookie(cookie, __uv.meta, true)) {\r\n            if (cookieStr.length) cookieStr += '; ';\r\n            cookieStr += `${cookie.name}=${cookie.value}`;\r\n        }\r\n\r\n        event.respondWith(event.data.value);\r\n    });\r\n\r\n    // HTML\r\n    client.element.on('setInnerHTML', (event) => {\r\n        switch (event.that.tagName) {\r\n            case 'SCRIPT':\r\n                event.data.value = __uv.js.rewrite(event.data.value);\r\n                break;\r\n            case 'STYLE':\r\n                event.data.value = __uv.rewriteCSS(event.data.value);\r\n                break;\r\n            default:\r\n                event.data.value = __uv.rewriteHtml(event.data.value);\r\n        }\r\n    });\r\n\r\n    client.element.on('getInnerHTML', (event) => {\r\n        switch (event.that.tagName) {\r\n            case 'SCRIPT':\r\n                event.data.value = __uv.js.source(event.data.value);\r\n                break;\r\n            default:\r\n                event.data.value = __uv.sourceHtml(event.data.value);\r\n        }\r\n    });\r\n\r\n    client.element.on('setOuterHTML', (event) => {\r\n        event.data.value = __uv.rewriteHtml(event.data.value, {\r\n            document: event.that.tagName === 'HTML',\r\n        });\r\n    });\r\n\r\n    client.element.on('getOuterHTML', (event) => {\r\n        switch (event.that.tagName) {\r\n            case 'HEAD':\r\n                event.data.value = __uv\r\n                    .sourceHtml(\r\n                        event.data.value.replace(\r\n                            /<head(.*)>(.*)<\\/head>/s,\r\n                            '<op-head$1>$2</op-head>'\r\n                        )\r\n                    )\r\n                    .replace(\r\n                        /<op-head(.*)>(.*)<\\/op-head>/s,\r\n                        '<head$1>$2</head>'\r\n                    );\r\n                break;\r\n            case 'BODY':\r\n                event.data.value = __uv\r\n                    .sourceHtml(\r\n                        event.data.value.replace(\r\n                            /<body(.*)>(.*)<\\/body>/s,\r\n                            '<op-body$1>$2</op-body>'\r\n                        )\r\n                    )\r\n                    .replace(\r\n                        /<op-body(.*)>(.*)<\\/op-body>/s,\r\n                        '<body$1>$2</body>'\r\n                    );\r\n                break;\r\n            default:\r\n                event.data.value = __uv.sourceHtml(event.data.value, {\r\n                    document: event.that.tagName === 'HTML',\r\n                });\r\n                break;\r\n        }\r\n\r\n        //event.data.value = __uv.sourceHtml(event.data.value, { document: event.that.tagName === 'HTML' });\r\n    });\r\n\r\n    client.document.on('write', (event) => {\r\n        if (!event.data.html.length) return false;\r\n        event.data.html = [__uv.rewriteHtml(event.data.html.join(''))];\r\n    });\r\n\r\n    client.document.on('writeln', (event) => {\r\n        if (!event.data.html.length) return false;\r\n        event.data.html = [__uv.rewriteHtml(event.data.html.join(''))];\r\n    });\r\n\r\n    client.element.on('insertAdjacentHTML', (event) => {\r\n        event.data.html = __uv.rewriteHtml(event.data.html);\r\n    });\r\n\r\n    // EventSource\r\n\r\n    client.eventSource.on('construct', (event) => {\r\n        event.data.url = __uv.rewriteUrl(event.data.url);\r\n    });\r\n\r\n    client.eventSource.on('url', (event) => {\r\n        event.data.url = __uv.rewriteUrl(event.data.url);\r\n    });\r\n\r\n    // IDB\r\n    client.idb.on('idbFactoryOpen', (event) => {\r\n        // Don't modify the Ultraviolet cookie database\r\n        if (event.data.name === '__op') return;\r\n        event.data.name = `${__uv.meta.url.origin}@${event.data.name}`;\r\n    });\r\n\r\n    client.idb.on('idbFactoryName', (event) => {\r\n        event.data.value = event.data.value.slice(\r\n            __uv.meta.url.origin.length + 1 /*the @*/\r\n        );\r\n    });\r\n\r\n    // History\r\n    client.history.on('replaceState', (event) => {\r\n        if (event.data.url)\r\n            event.data.url = __uv.rewriteUrl(\r\n                event.data.url,\r\n                '__uv' in event.that ? event.that.__uv.meta : __uv.meta\r\n            );\r\n    });\r\n    client.history.on('pushState', (event) => {\r\n        if (event.data.url)\r\n            event.data.url = __uv.rewriteUrl(\r\n                event.data.url,\r\n                '__uv' in event.that ? event.that.__uv.meta : __uv.meta\r\n            );\r\n    });\r\n\r\n    // Element get set attribute methods\r\n    client.element.on('getAttribute', (event) => {\r\n        if (\r\n            client.element.hasAttribute.call(\r\n                event.that,\r\n                __uv.attributePrefix + '-attr-' + event.data.name\r\n            )\r\n        ) {\r\n            event.respondWith(\r\n                event.target.call(\r\n                    event.that,\r\n                    __uv.attributePrefix + '-attr-' + event.data.name\r\n                )\r\n            );\r\n        }\r\n    });\r\n\r\n    // Message\r\n    client.message.on('postMessage', (event) => {\r\n        let to = event.data.origin;\r\n        let call = __uv.call;\r\n\r\n        if (event.that) {\r\n            call = event.that.__uv$source.call;\r\n        }\r\n\r\n        event.data.origin = '*';\r\n        event.data.message = {\r\n            __data: event.data.message,\r\n            __origin: (event.that || event.target).__uv$source.location.origin,\r\n            __to: to,\r\n        };\r\n\r\n        event.respondWith(\r\n            worker\r\n                ? call(\r\n                      event.target,\r\n                      [event.data.message, event.data.transfer],\r\n                      event.that\r\n                  )\r\n                : call(\r\n                      event.target,\r\n                      [\r\n                          event.data.message,\r\n                          event.data.origin,\r\n                          event.data.transfer,\r\n                      ],\r\n                      event.that\r\n                  )\r\n        );\r\n    });\r\n\r\n    client.message.on('data', (event) => {\r\n        const { value: data } = event.data;\r\n        if (\r\n            typeof data === 'object' &&\r\n            '__data' in data &&\r\n            '__origin' in data\r\n        ) {\r\n            event.respondWith(data.__data);\r\n        }\r\n    });\r\n\r\n    client.message.on('origin', (event) => {\r\n        const data = client.message.messageData.get.call(event.that);\r\n        if (typeof data === 'object' && data.__data && data.__origin) {\r\n            event.respondWith(data.__origin);\r\n        }\r\n    });\r\n\r\n    client.overrideDescriptor(window, 'origin', {\r\n        get: () => {\r\n            return __uv.location.origin;\r\n        },\r\n    });\r\n\r\n    client.node.on('baseURI', (event) => {\r\n        if (event.data.value.startsWith(window.location.origin))\r\n            event.data.value = __uv.sourceUrl(event.data.value);\r\n    });\r\n\r\n    client.element.on('setAttribute', (event) => {\r\n        if (\r\n            event.that instanceof HTMLMediaElement &&\r\n            event.data.name === 'src' &&\r\n            event.data.value.startsWith('blob:')\r\n        ) {\r\n            event.target.call(\r\n                event.that,\r\n                __uv.attributePrefix + '-attr-' + event.data.name,\r\n                event.data.value\r\n            );\r\n            event.data.value = __uv.blobUrls.get(event.data.value);\r\n            return;\r\n        }\r\n\r\n        if (__uv.attrs.isUrl(event.data.name)) {\r\n            event.target.call(\r\n                event.that,\r\n                __uv.attributePrefix + '-attr-' + event.data.name,\r\n                event.data.value\r\n            );\r\n            event.data.value = __uv.rewriteUrl(event.data.value);\r\n        }\r\n\r\n        if (__uv.attrs.isStyle(event.data.name)) {\r\n            event.target.call(\r\n                event.that,\r\n                __uv.attributePrefix + '-attr-' + event.data.name,\r\n                event.data.value\r\n            );\r\n            event.data.value = __uv.rewriteCSS(event.data.value, {\r\n                context: 'declarationList',\r\n            });\r\n        }\r\n\r\n        if (__uv.attrs.isHtml(event.data.name)) {\r\n            event.target.call(\r\n                event.that,\r\n                __uv.attributePrefix + '-attr-' + event.data.name,\r\n                event.data.value\r\n            );\r\n            event.data.value = __uv.rewriteHtml(event.data.value, {\r\n                ...__uv.meta,\r\n                document: true,\r\n                injectHead: __uv.createHtmlInject(\r\n                    __uv.handlerScript,\r\n                    __uv.bundleScript,\r\n                    __uv.clientScript,\r\n                    __uv.configScript,\r\n                    __uv$bareURL,\r\n                    __uv$bareData,\r\n                    cookieStr,\r\n                    window.location.href\r\n                ),\r\n            });\r\n        }\r\n\r\n        if (__uv.attrs.isSrcset(event.data.name)) {\r\n            event.target.call(\r\n                event.that,\r\n                __uv.attributePrefix + '-attr-' + event.data.name,\r\n                event.data.value\r\n            );\r\n            event.data.value = __uv.html.wrapSrcset(\r\n                event.data.value.toString()\r\n            );\r\n        }\r\n\r\n        if (__uv.attrs.isForbidden(event.data.name)) {\r\n            event.data.name = __uv.attributePrefix + '-attr-' + event.data.name;\r\n        }\r\n    });\r\n\r\n    client.element.on('audio', (event) => {\r\n        event.data.url = __uv.rewriteUrl(event.data.url);\r\n    });\r\n\r\n    // Element Property Attributes\r\n    client.element.hookProperty(\r\n        [HTMLAnchorElement, HTMLAreaElement, HTMLLinkElement, HTMLBaseElement],\r\n        'href',\r\n        {\r\n            get: (target, that) => {\r\n                return __uv.sourceUrl(target.call(that));\r\n            },\r\n            set: (target, that, [val]) => {\r\n                client.element.setAttribute.call(\r\n                    that,\r\n                    __uv.attributePrefix + '-attr-href',\r\n                    val\r\n                );\r\n                target.call(that, __uv.rewriteUrl(val));\r\n            },\r\n        }\r\n    );\r\n\r\n    client.element.hookProperty(\r\n        [\r\n            HTMLScriptElement,\r\n            HTMLAudioElement,\r\n            HTMLVideoElement,\r\n            HTMLMediaElement,\r\n            HTMLImageElement,\r\n            HTMLInputElement,\r\n            HTMLEmbedElement,\r\n            HTMLIFrameElement,\r\n            HTMLTrackElement,\r\n            HTMLSourceElement,\r\n        ],\r\n        'src',\r\n        {\r\n            get: (target, that) => {\r\n                return __uv.sourceUrl(target.call(that));\r\n            },\r\n            set: (target, that, [val]) => {\r\n                if (\r\n                    new String(val).toString().trim().startsWith('blob:') &&\r\n                    that instanceof HTMLMediaElement\r\n                ) {\r\n                    client.element.setAttribute.call(\r\n                        that,\r\n                        __uv.attributePrefix + '-attr-src',\r\n                        val\r\n                    );\r\n                    return target.call(that, __uv.blobUrls.get(val) || val);\r\n                }\r\n\r\n                client.element.setAttribute.call(\r\n                    that,\r\n                    __uv.attributePrefix + '-attr-src',\r\n                    val\r\n                );\r\n                target.call(that, __uv.rewriteUrl(val));\r\n            },\r\n        }\r\n    );\r\n\r\n    client.element.hookProperty([HTMLFormElement], 'action', {\r\n        get: (target, that) => {\r\n            return __uv.sourceUrl(target.call(that));\r\n        },\r\n        set: (target, that, [val]) => {\r\n            client.element.setAttribute.call(\r\n                that,\r\n                __uv.attributePrefix + '-attr-action',\r\n                val\r\n            );\r\n            target.call(that, __uv.rewriteUrl(val));\r\n        },\r\n    });\r\n\r\n    client.element.hookProperty([HTMLImageElement], 'srcset', {\r\n        get: (target, that) => {\r\n            return (\r\n                client.element.getAttribute.call(\r\n                    that,\r\n                    __uv.attributePrefix + '-attr-srcset'\r\n                ) || target.call(that)\r\n            );\r\n        },\r\n        set: (target, that, [val]) => {\r\n            client.element.setAttribute.call(\r\n                that,\r\n                __uv.attributePrefix + '-attr-srcset',\r\n                val\r\n            );\r\n            target.call(that, __uv.html.wrapSrcset(val.toString()));\r\n        },\r\n    });\r\n\r\n    client.element.hookProperty(HTMLScriptElement, 'integrity', {\r\n        get: (target, that) => {\r\n            return client.element.getAttribute.call(\r\n                that,\r\n                __uv.attributePrefix + '-attr-integrity'\r\n            );\r\n        },\r\n        set: (target, that, [val]) => {\r\n            client.element.setAttribute.call(\r\n                that,\r\n                __uv.attributePrefix + '-attr-integrity',\r\n                val\r\n            );\r\n        },\r\n    });\r\n\r\n    client.element.hookProperty(HTMLIFrameElement, 'sandbox', {\r\n        get: (target, that) => {\r\n            return (\r\n                client.element.getAttribute.call(\r\n                    that,\r\n                    __uv.attributePrefix + '-attr-sandbox'\r\n                ) || target.call(that)\r\n            );\r\n        },\r\n        set: (target, that, [val]) => {\r\n            client.element.setAttribute.call(\r\n                that,\r\n                __uv.attributePrefix + '-attr-sandbox',\r\n                val\r\n            );\r\n        },\r\n    });\r\n\r\n    // HTMLIFrameElement may not be defined (workers)\r\n    const contentWindowGet =\r\n        HTMLIFrameElement &&\r\n        Object.getOwnPropertyDescriptor(\r\n            HTMLIFrameElement.prototype,\r\n            'contentWindow'\r\n        ).get;\r\n\r\n    function uvInject(that) {\r\n        const win = contentWindowGet.call(that);\r\n\r\n        if (!win.__uv)\r\n            try {\r\n                __uvHook(win);\r\n            } catch (e) {\r\n                console.error('catastrophic failure');\r\n                console.error(e);\r\n            }\r\n    }\r\n\r\n    client.element.hookProperty(HTMLIFrameElement, 'contentWindow', {\r\n        get: (target, that) => {\r\n            uvInject(that);\r\n            return target.call(that);\r\n        },\r\n    });\r\n\r\n    client.element.hookProperty(HTMLIFrameElement, 'contentDocument', {\r\n        get: (target, that) => {\r\n            uvInject(that);\r\n            return target.call(that);\r\n        },\r\n    });\r\n\r\n    client.element.hookProperty(HTMLIFrameElement, 'srcdoc', {\r\n        get: (target, that) => {\r\n            return (\r\n                client.element.getAttribute.call(\r\n                    that,\r\n                    __uv.attributePrefix + '-attr-srcdoc'\r\n                ) || target.call(that)\r\n            );\r\n        },\r\n        set: (target, that, [val]) => {\r\n            target.call(\r\n                that,\r\n                __uv.rewriteHtml(val, {\r\n                    document: true,\r\n                    injectHead: __uv.createHtmlInject(\r\n                        __uv.handlerScript,\r\n                        __uv.bundleScript,\r\n                        __uv.clientScript,\r\n                        __uv.configScript,\r\n                        __uv$bareURL,\r\n                        __uv$bareData,\r\n                        cookieStr,\r\n                        window.location.href\r\n                    ),\r\n                })\r\n            );\r\n        },\r\n    });\r\n\r\n    client.node.on('getTextContent', (event) => {\r\n        if (event.that.tagName === 'SCRIPT') {\r\n            event.data.value = __uv.js.source(event.data.value);\r\n        }\r\n    });\r\n\r\n    client.node.on('setTextContent', (event) => {\r\n        if (event.that.tagName === 'SCRIPT') {\r\n            event.data.value = __uv.js.rewrite(event.data.value);\r\n        }\r\n    });\r\n\r\n    // Until proper rewriting is implemented for service workers.\r\n    // Not sure atm how to implement it with the already built in service worker\r\n    if ('serviceWorker' in window.navigator) {\r\n        delete window.Navigator.prototype.serviceWorker;\r\n    }\r\n\r\n    // Document\r\n    client.document.on('getDomain', (event) => {\r\n        event.data.value = __uv.domain;\r\n    });\r\n    client.document.on('setDomain', (event) => {\r\n        if (\r\n            !event.data.value\r\n                .toString()\r\n                .endsWith(__uv.meta.url.hostname.split('.').slice(-2).join('.'))\r\n        )\r\n            return event.respondWith('');\r\n        event.respondWith((__uv.domain = event.data.value));\r\n    });\r\n\r\n    client.document.on('url', (event) => {\r\n        event.data.value = __uv.location.href;\r\n    });\r\n\r\n    client.document.on('documentURI', (event) => {\r\n        event.data.value = __uv.location.href;\r\n    });\r\n\r\n    client.document.on('referrer', (event) => {\r\n        event.data.value = __uv.referrer || __uv.sourceUrl(event.data.value);\r\n    });\r\n\r\n    client.document.on('parseFromString', (event) => {\r\n        if (event.data.type !== 'text/html') return false;\r\n        event.data.string = __uv.rewriteHtml(event.data.string, {\r\n            ...__uv.meta,\r\n            document: true,\r\n        });\r\n    });\r\n\r\n    // Attribute (node.attributes)\r\n    client.attribute.on('getValue', (event) => {\r\n        if (\r\n            client.element.hasAttribute.call(\r\n                event.that.ownerElement,\r\n                __uv.attributePrefix + '-attr-' + event.data.name\r\n            )\r\n        ) {\r\n            event.data.value = client.element.getAttribute.call(\r\n                event.that.ownerElement,\r\n                __uv.attributePrefix + '-attr-' + event.data.name\r\n            );\r\n        }\r\n    });\r\n\r\n    client.attribute.on('setValue', (event) => {\r\n        if (__uv.attrs.isUrl(event.data.name)) {\r\n            client.element.setAttribute.call(\r\n                event.that.ownerElement,\r\n                __uv.attributePrefix + '-attr-' + event.data.name,\r\n                event.data.value\r\n            );\r\n            event.data.value = __uv.rewriteUrl(event.data.value);\r\n        }\r\n\r\n        if (__uv.attrs.isStyle(event.data.name)) {\r\n            client.element.setAttribute.call(\r\n                event.that.ownerElement,\r\n                __uv.attributePrefix + '-attr-' + event.data.name,\r\n                event.data.value\r\n            );\r\n            event.data.value = __uv.rewriteCSS(event.data.value, {\r\n                context: 'declarationList',\r\n            });\r\n        }\r\n\r\n        if (__uv.attrs.isHtml(event.data.name)) {\r\n            client.element.setAttribute.call(\r\n                event.that.ownerElement,\r\n                __uv.attributePrefix + '-attr-' + event.data.name,\r\n                event.data.value\r\n            );\r\n            event.data.value = __uv.rewriteHtml(event.data.value, {\r\n                ...__uv.meta,\r\n                document: true,\r\n                injectHead: __uv.createHtmlInject(\r\n                    __uv.handlerScript,\r\n                    __uv.bundleScript,\r\n                    __uv.clientScript,\r\n                    __uv.configScript,\r\n                    __uv$bareURL,\r\n                    __uv$bareData,\r\n                    cookieStr,\r\n                    window.location.href\r\n                ),\r\n            });\r\n        }\r\n\r\n        if (__uv.attrs.isSrcset(event.data.name)) {\r\n            client.element.setAttribute.call(\r\n                event.that.ownerElement,\r\n                __uv.attributePrefix + '-attr-' + event.data.name,\r\n                event.data.value\r\n            );\r\n            event.data.value = __uv.html.wrapSrcset(\r\n                event.data.value.toString()\r\n            );\r\n        }\r\n    });\r\n\r\n    // URL\r\n    client.url.on('createObjectURL', (event) => {\r\n        let url = event.target.call(event.that, event.data.object);\r\n        if (url.startsWith('blob:' + location.origin)) {\r\n            let newUrl =\r\n                'blob:' +\r\n                (__uv.meta.url.href !== 'about:blank'\r\n                    ? __uv.meta.url.origin\r\n                    : window.parent.__uv.meta.url.origin) +\r\n                url.slice('blob:'.length + location.origin.length);\r\n            __uv.blobUrls.set(newUrl, url);\r\n            event.respondWith(newUrl);\r\n        } else {\r\n            event.respondWith(url);\r\n        }\r\n    });\r\n\r\n    client.url.on('revokeObjectURL', (event) => {\r\n        if (__uv.blobUrls.has(event.data.url)) {\r\n            const old = event.data.url;\r\n            event.data.url = __uv.blobUrls.get(event.data.url);\r\n            __uv.blobUrls.delete(old);\r\n        }\r\n    });\r\n\r\n    client.storage.on('get', (event) => {\r\n        event.data.name =\r\n            methodPrefix + __uv.meta.url.origin + '@' + event.data.name;\r\n    });\r\n\r\n    client.storage.on('set', (event) => {\r\n        if (event.that.__uv$storageObj) {\r\n            event.that.__uv$storageObj[event.data.name] = event.data.value;\r\n        }\r\n        event.data.name =\r\n            methodPrefix + __uv.meta.url.origin + '@' + event.data.name;\r\n    });\r\n\r\n    client.storage.on('delete', (event) => {\r\n        if (event.that.__uv$storageObj) {\r\n            delete event.that.__uv$storageObj[event.data.name];\r\n        }\r\n        event.data.name =\r\n            methodPrefix + __uv.meta.url.origin + '@' + event.data.name;\r\n    });\r\n\r\n    client.storage.on('getItem', (event) => {\r\n        event.data.name =\r\n            methodPrefix + __uv.meta.url.origin + '@' + event.data.name;\r\n    });\r\n\r\n    client.storage.on('setItem', (event) => {\r\n        if (event.that.__uv$storageObj) {\r\n            event.that.__uv$storageObj[event.data.name] = event.data.value;\r\n        }\r\n        event.data.name =\r\n            methodPrefix + __uv.meta.url.origin + '@' + event.data.name;\r\n    });\r\n\r\n    client.storage.on('removeItem', (event) => {\r\n        if (event.that.__uv$storageObj) {\r\n            delete event.that.__uv$storageObj[event.data.name];\r\n        }\r\n        event.data.name =\r\n            methodPrefix + __uv.meta.url.origin + '@' + event.data.name;\r\n    });\r\n\r\n    client.storage.on('clear', (event) => {\r\n        if (event.that.__uv$storageObj) {\r\n            for (const key of client.nativeMethods.keys.call(\r\n                null,\r\n                event.that.__uv$storageObj\r\n            )) {\r\n                delete event.that.__uv$storageObj[key];\r\n                client.storage.removeItem.call(\r\n                    event.that,\r\n                    methodPrefix + __uv.meta.url.origin + '@' + key\r\n                );\r\n                event.respondWith();\r\n            }\r\n        }\r\n    });\r\n\r\n    client.storage.on('length', (event) => {\r\n        if (event.that.__uv$storageObj) {\r\n            event.respondWith(\r\n                client.nativeMethods.keys.call(null, event.that.__uv$storageObj)\r\n                    .length\r\n            );\r\n        }\r\n    });\r\n\r\n    client.storage.on('key', (event) => {\r\n        if (event.that.__uv$storageObj) {\r\n            event.respondWith(\r\n                client.nativeMethods.keys.call(\r\n                    null,\r\n                    event.that.__uv$storageObj\r\n                )[event.data.index] || null\r\n            );\r\n        }\r\n    });\r\n\r\n    client.websocket.on('websocket', async (event) => {\r\n        const requestHeaders = Object.create(null);\r\n        requestHeaders['Origin'] = __uv.meta.url.origin;\r\n        requestHeaders['User-Agent'] = navigator.userAgent;\r\n\r\n        if (cookieStr !== '') requestHeaders['Cookie'] = cookieStr.toString();\r\n\r\n        event.respondWith(\r\n            bareClient.createWebSocket(event.data.args[0], event.data.args[1], {\r\n                headers: requestHeaders,\r\n                readyStateHook: (socket, getReadyState) => {\r\n                    socket.__uv$getReadyState = getReadyState;\r\n                },\r\n                sendErrorHook: (socket, getSendError) => {\r\n                    socket.__uv$getSendError = getSendError;\r\n                },\r\n                urlHook: (socket, url) => {\r\n                    socket.__uv$socketUrl = url;\r\n                },\r\n                protocolHook: (socket, getProtocol) => {\r\n                    socket.__uv$getProtocol = getProtocol;\r\n                },\r\n                setCookiesCallback: (setCookies) => {\r\n                    // document.cookie is hooked\r\n                    // so we can just call it\r\n                    for (const cookie of setCookies)\r\n                        window.document.cookie = cookie;\r\n                },\r\n                webSocketImpl: event.target,\r\n            })\r\n        );\r\n    });\r\n\r\n    client.websocket.on('readyState', (event) => {\r\n        if ('__uv$getReadyState' in event.that)\r\n            event.data.value = event.that.__uv$getReadyState();\r\n    });\r\n\r\n    client.websocket.on('send', (event) => {\r\n        if ('__uv$getSendError' in event.that) {\r\n            const error = event.that.__uv$getSendError();\r\n            if (error) throw error;\r\n        }\r\n    });\r\n\r\n    client.websocket.on('url', (event) => {\r\n        if ('__uv$socketUrl' in event.that)\r\n            event.data.value = event.that.__uv$socketUrl.toString();\r\n    });\r\n\r\n    client.websocket.on('protocol', (event) => {\r\n        if ('__uv$getProtocol' in event.that)\r\n            event.data.value = event.that.__uv$getProtocol();\r\n    });\r\n\r\n    client.function.on('function', (event) => {\r\n        event.data.script = __uv.rewriteJS(event.data.script);\r\n    });\r\n\r\n    client.function.on('toString', (event) => {\r\n        if (__uv.methods.string in event.that)\r\n            event.respondWith(event.that[__uv.methods.string]);\r\n    });\r\n\r\n    client.object.on('getOwnPropertyNames', (event) => {\r\n        event.data.names = event.data.names.filter(\r\n            (element) => !__uv.filterKeys.includes(element)\r\n        );\r\n    });\r\n\r\n    client.object.on('getOwnPropertyDescriptors', (event) => {\r\n        for (const forbidden of __uv.filterKeys) {\r\n            delete event.data.descriptors[forbidden];\r\n        }\r\n    });\r\n\r\n    client.style.on('setProperty', (event) => {\r\n        if (client.style.dashedUrlProps.includes(event.data.property)) {\r\n            event.data.value = __uv.rewriteCSS(event.data.value, {\r\n                context: 'value',\r\n                ...__uv.meta,\r\n            });\r\n        }\r\n    });\r\n\r\n    client.style.on('getPropertyValue', (event) => {\r\n        if (client.style.dashedUrlProps.includes(event.data.property)) {\r\n            event.respondWith(\r\n                __uv.sourceCSS(\r\n                    event.target.call(event.that, event.data.property),\r\n                    {\r\n                        context: 'value',\r\n                        ...__uv.meta,\r\n                    }\r\n                )\r\n            );\r\n        }\r\n    });\r\n\r\n    if ('CSS2Properties' in window) {\r\n        for (const key of client.style.urlProps) {\r\n            client.overrideDescriptor(window.CSS2Properties.prototype, key, {\r\n                get: (target, that) => {\r\n                    return __uv.sourceCSS(target.call(that), {\r\n                        context: 'value',\r\n                        ...__uv.meta,\r\n                    });\r\n                },\r\n                set: (target, that, val) => {\r\n                    target.call(\r\n                        that,\r\n                        __uv.rewriteCSS(val, {\r\n                            context: 'value',\r\n                            ...__uv.meta,\r\n                        })\r\n                    );\r\n                },\r\n            });\r\n        }\r\n    } else if ('HTMLElement' in window) {\r\n        client.overrideDescriptor(window.HTMLElement.prototype, 'style', {\r\n            get: (target, that) => {\r\n                const value = target.call(that);\r\n                if (!value[methodPrefix + 'modifiedStyle']) {\r\n                    for (const key of client.style.urlProps) {\r\n                        client.nativeMethods.defineProperty(value, key, {\r\n                            enumerable: true,\r\n                            configurable: true,\r\n                            get() {\r\n                                const value =\r\n                                    client.style.getPropertyValue.call(\r\n                                        this,\r\n                                        key\r\n                                    ) || '';\r\n                                return __uv.sourceCSS(value, {\r\n                                    context: 'value',\r\n                                    ...__uv.meta,\r\n                                });\r\n                            },\r\n                            set(val) {\r\n                                client.style.setProperty.call(\r\n                                    this,\r\n                                    client.style.propToDashed[key] || key,\r\n                                    __uv.rewriteCSS(val, {\r\n                                        context: 'value',\r\n                                        ...__uv.meta,\r\n                                    })\r\n                                );\r\n                            },\r\n                        });\r\n                        client.nativeMethods.defineProperty(\r\n                            value,\r\n                            methodPrefix + 'modifiedStyle',\r\n                            {\r\n                                enumerable: false,\r\n                                value: true,\r\n                            }\r\n                        );\r\n                    }\r\n                }\r\n                return value;\r\n            },\r\n        });\r\n    }\r\n\r\n    client.style.on('setCssText', (event) => {\r\n        event.data.value = __uv.rewriteCSS(event.data.value, {\r\n            context: 'declarationList',\r\n            ...__uv.meta,\r\n        });\r\n    });\r\n\r\n    client.style.on('getCssText', (event) => {\r\n        event.data.value = __uv.sourceCSS(event.data.value, {\r\n            context: 'declarationList',\r\n            ...__uv.meta,\r\n        });\r\n    });\r\n\r\n    // Proper hash emulation.\r\n    __uv.addEventListener.call(window, 'hashchange', (event) => {\r\n        if (event.__uv$dispatched) return false;\r\n        event.stopImmediatePropagation();\r\n        const hash = window.location.hash;\r\n        client.history.replaceState.call(window.history, '', '', event.oldURL);\r\n        __uv.location.hash = hash;\r\n    });\r\n\r\n    client.location.on('hashchange', (oldUrl, newUrl, ctx) => {\r\n        if (ctx.HashChangeEvent && client.history.replaceState) {\r\n            client.history.replaceState.call(\r\n                window.history,\r\n                '',\r\n                '',\r\n                __uv.rewriteUrl(newUrl)\r\n            );\r\n\r\n            const event = new ctx.HashChangeEvent('hashchange', {\r\n                newURL: newUrl,\r\n                oldURL: oldUrl,\r\n            });\r\n\r\n            client.nativeMethods.defineProperty(\r\n                event,\r\n                methodPrefix + 'dispatched',\r\n                {\r\n                    value: true,\r\n                    enumerable: false,\r\n                }\r\n            );\r\n\r\n            __uv.dispatchEvent.call(window, event);\r\n        }\r\n    });\r\n\r\n    // Hooking functions & descriptors\r\n    client.fetch.overrideRequest();\r\n    client.fetch.overrideUrl();\r\n    client.xhr.overrideOpen();\r\n    client.xhr.overrideResponseUrl();\r\n    client.element.overrideHtml();\r\n    client.element.overrideAttribute();\r\n    client.element.overrideInsertAdjacentHTML();\r\n    client.element.overrideAudio();\r\n    // client.element.overrideQuerySelector();\r\n    client.node.overrideBaseURI();\r\n    client.node.overrideTextContent();\r\n    client.attribute.overrideNameValue();\r\n    client.document.overrideDomain();\r\n    client.document.overrideURL();\r\n    client.document.overrideDocumentURI();\r\n    client.document.overrideWrite();\r\n    client.document.overrideReferrer();\r\n    client.document.overrideParseFromString();\r\n    client.storage.overrideMethods();\r\n    client.storage.overrideLength();\r\n    //client.document.overrideQuerySelector();\r\n    client.object.overrideGetPropertyNames();\r\n    client.object.overrideGetOwnPropertyDescriptors();\r\n    client.idb.overrideName();\r\n    client.idb.overrideOpen();\r\n    client.history.overridePushState();\r\n    client.history.overrideReplaceState();\r\n    client.eventSource.overrideConstruct();\r\n    client.eventSource.overrideUrl();\r\n    client.websocket.overrideWebSocket();\r\n    client.websocket.overrideProtocol();\r\n    client.websocket.overrideURL();\r\n    client.websocket.overrideReadyState();\r\n    client.websocket.overrideProtocol();\r\n    client.websocket.overrideSend();\r\n    client.url.overrideObjectURL();\r\n    client.document.overrideCookie();\r\n    client.message.overridePostMessage();\r\n    client.message.overrideMessageOrigin();\r\n    client.message.overrideMessageData();\r\n    client.workers.overrideWorker();\r\n    client.workers.overrideAddModule();\r\n    client.workers.overrideImportScripts();\r\n    client.workers.overridePostMessage();\r\n    client.style.overrideSetGetProperty();\r\n    client.style.overrideCssText();\r\n    client.navigator.overrideSendBeacon();\r\n    client.function.overrideFunction();\r\n    client.function.overrideToString();\r\n    client.location.overrideWorkerLocation((href) => {\r\n        return new URL(__uv.sourceUrl(href));\r\n    });\r\n\r\n    client.overrideDescriptor(window, 'localStorage', {\r\n        get: (target, that) => {\r\n            return (that || window).__uv.lsWrap;\r\n        },\r\n    });\r\n    client.overrideDescriptor(window, 'sessionStorage', {\r\n        get: (target, that) => {\r\n            return (that || window).__uv.ssWrap;\r\n        },\r\n    });\r\n\r\n    client.override(window, 'open', (target, that, args) => {\r\n        if (!args.length) return target.apply(that, args);\r\n        let [url] = args;\r\n\r\n        url = __uv.rewriteUrl(url);\r\n\r\n        return target.call(that, url);\r\n    });\r\n\r\n    __uv.$wrap = function (name) {\r\n        if (name === 'location') return __uv.methods.location;\r\n        if (name === 'eval') return __uv.methods.eval;\r\n        return name;\r\n    };\r\n\r\n    __uv.$get = function (that) {\r\n        if (that === window.location) return __uv.location;\r\n        if (that === window.eval) return __uv.eval;\r\n        if (that === window.parent) {\r\n            return window.__uv$parent;\r\n        }\r\n        if (that === window.top) {\r\n            return window.__uv$top;\r\n        }\r\n        return that;\r\n    };\r\n\r\n    __uv.eval = client.wrap(window, 'eval', (target, that, args) => {\r\n        if (!args.length || typeof args[0] !== 'string')\r\n            return target.apply(that, args);\r\n        let [script] = args;\r\n\r\n        script = __uv.rewriteJS(script);\r\n        return target.call(that, script);\r\n    });\r\n\r\n    __uv.call = function (target, args, that) {\r\n        return that ? target.apply(that, args) : target(...args);\r\n    };\r\n\r\n    __uv.call$ = function (obj, prop, args = []) {\r\n        return obj[prop].apply(obj, args);\r\n    };\r\n\r\n    client.nativeMethods.defineProperty(window.Object.prototype, master, {\r\n        get: () => {\r\n            return __uv;\r\n        },\r\n        enumerable: false,\r\n    });\r\n\r\n    client.nativeMethods.defineProperty(\r\n        window.Object.prototype,\r\n        __uv.methods.setSource,\r\n        {\r\n            value: function (source) {\r\n                if (!client.nativeMethods.isExtensible(this)) return this;\r\n\r\n                client.nativeMethods.defineProperty(this, __uv.methods.source, {\r\n                    value: source,\r\n                    writable: true,\r\n                    enumerable: false,\r\n                });\r\n\r\n                return this;\r\n            },\r\n            enumerable: false,\r\n        }\r\n    );\r\n\r\n    client.nativeMethods.defineProperty(\r\n        window.Object.prototype,\r\n        __uv.methods.source,\r\n        {\r\n            value: __uv,\r\n            writable: true,\r\n            enumerable: false,\r\n        }\r\n    );\r\n\r\n    client.nativeMethods.defineProperty(\r\n        window.Object.prototype,\r\n        __uv.methods.location,\r\n        {\r\n            configurable: true,\r\n            get() {\r\n                return this === window.document || this === window\r\n                    ? __uv.location\r\n                    : this.location;\r\n            },\r\n            set(val) {\r\n                if (this === window.document || this === window) {\r\n                    __uv.location.href = val;\r\n                } else {\r\n                    this.location = val;\r\n                }\r\n            },\r\n        }\r\n    );\r\n\r\n    client.nativeMethods.defineProperty(\r\n        window.Object.prototype,\r\n        __uv.methods.parent,\r\n        {\r\n            configurable: true,\r\n            get() {\r\n                const val = this.parent;\r\n\r\n                if (this === window) {\r\n                    try {\r\n                        return '__uv' in val ? val : this;\r\n                    } catch (e) {\r\n                        return this;\r\n                    }\r\n                }\r\n                return val;\r\n            },\r\n            set(val) {\r\n                this.parent = val;\r\n            },\r\n        }\r\n    );\r\n\r\n    client.nativeMethods.defineProperty(\r\n        window.Object.prototype,\r\n        __uv.methods.top,\r\n        {\r\n            configurable: true,\r\n            get() {\r\n                const val = this.top;\r\n\r\n                if (this === window) {\r\n                    if (val === this.parent) return this[__uv.methods.parent];\r\n                    try {\r\n                        if (!('__uv' in val)) {\r\n                            let current = this;\r\n\r\n                            while (current.parent !== val) {\r\n                                current = current.parent;\r\n                            }\r\n\r\n                            return '__uv' in current ? current : this;\r\n                        } else {\r\n                            return val;\r\n                        }\r\n                    } catch (e) {\r\n                        return this;\r\n                    }\r\n                }\r\n                return val;\r\n            },\r\n            set(val) {\r\n                this.top = val;\r\n            },\r\n        }\r\n    );\r\n\r\n    client.nativeMethods.defineProperty(\r\n        window.Object.prototype,\r\n        __uv.methods.eval,\r\n        {\r\n            configurable: true,\r\n            get() {\r\n                return this === window ? __uv.eval : this.eval;\r\n            },\r\n            set(val) {\r\n                this.eval = val;\r\n            },\r\n        }\r\n    );\r\n}\r\n"],"names":["Ultraviolet","self","UVClient","__uv$config","__uv$bareData","__uv$bareURL","__uv$cookies","TypeError","__uvHook","window","__uv","document","querySelectorAll","forEach","node","remove","worker","master","methodPrefix","bareClient","BareClient","client","HTMLMediaElement","HTMLScriptElement","HTMLAudioElement","HTMLVideoElement","HTMLInputElement","HTMLEmbedElement","HTMLTrackElement","HTMLAnchorElement","HTMLIFrameElement","HTMLAreaElement","HTMLLinkElement","HTMLBaseElement","HTMLFormElement","HTMLImageElement","HTMLSourceElement","nativeMethods","defineProperty","value","enumerable","meta","origin","location","emulate","href","URL","startsWith","slice","length","sourceUrl","rewriteUrl","cookieStr","url","domain","host","blobUrls","Map","referrer","cookies","localStorageObj","sessionStorageObj","parent","EventTarget","addEventListener","prototype","removeListener","dispatchEvent","storage","storeProto","get","this","sessionStorage","localStorage","key","getItem","lsWrap","ssWrap","rawBase","baseURI","call","base","methods","setSource","source","function","string","eval","top","filterKeys","on","target","wrapped","getOwnPropertyDescriptor","fnToString","fetch","event","data","input","xhr","workers","i","scripts","to","message","__data","__origin","__to","navigator","cookie","db","then","setCookies","getCookies","serialize","setCookie","path","hostname","validateCookie","name","respondWith","element","that","tagName","js","rewrite","rewriteCSS","rewriteHtml","sourceHtml","replace","html","join","eventSource","idb","history","hasAttribute","attributePrefix","__uv$source","transfer","messageData","overrideDescriptor","attrs","isUrl","isStyle","context","isHtml","injectHead","createHtmlInject","handlerScript","bundleScript","clientScript","configScript","isSrcset","wrapSrcset","toString","isForbidden","hookProperty","set","val","setAttribute","String","trim","getAttribute","contentWindowGet","Object","uvInject","win","e","console","error","Navigator","serviceWorker","endsWith","split","type","attribute","ownerElement","object","newUrl","has","old","delete","__uv$storageObj","keys","removeItem","index","websocket","async","requestHeaders","create","userAgent","createWebSocket","args","headers","readyStateHook","socket","getReadyState","__uv$getReadyState","sendErrorHook","getSendError","__uv$getSendError","urlHook","__uv$socketUrl","protocolHook","getProtocol","__uv$getProtocol","setCookiesCallback","webSocketImpl","script","rewriteJS","names","filter","includes","forbidden","descriptors","style","dashedUrlProps","property","sourceCSS","urlProps","CSS2Properties","HTMLElement","configurable","getPropertyValue","setProperty","propToDashed","__uv$dispatched","stopImmediatePropagation","hash","replaceState","oldURL","oldUrl","ctx","HashChangeEvent","newURL","overrideRequest","overrideUrl","overrideOpen","overrideResponseUrl","overrideHtml","overrideAttribute","overrideInsertAdjacentHTML","overrideAudio","overrideBaseURI","overrideTextContent","overrideNameValue","overrideDomain","overrideURL","overrideDocumentURI","overrideWrite","overrideReferrer","overrideParseFromString","overrideMethods","overrideLength","overrideGetPropertyNames","overrideGetOwnPropertyDescriptors","overrideName","overridePushState","overrideReplaceState","overrideConstruct","overrideWebSocket","overrideProtocol","overrideReadyState","overrideSend","overrideObjectURL","overrideCookie","overridePostMessage","overrideMessageOrigin","overrideMessageData","overrideWorker","overrideAddModule","overrideImportScripts","overrideSetGetProperty","overrideCssText","overrideSendBeacon","overrideFunction","overrideToString","overrideWorkerLocation","override","apply","$wrap","$get","__uv$parent","__uv$top","wrap","call$","obj","prop","isExtensible","writable","current"],"sourceRoot":""}